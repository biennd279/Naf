% !TeX root = ../main.tex
\documentclass[./../main.tex]{subfiles}

\begin{document}
\subsection{Zed Attack Proxy (ZAP)}
OWASP Zed Attack Proxy (thường được gọi là  ZAP hay ZAProxy) là công cụ mã nguồn mở,
công cụ cho phép các các kỹ sư an toàn thông tin tìm kiếm được lỗ hổng một cách tự
động/bán tự động/thủ công thông qua cơ chế “middle-in-the-middle-proxy” giúp người
dùng đứng giữa ứng dụng Web để thực hiện kiểm thử qua các plugin trong được xây dựng
trong cộng đồng.

Điểm mạnh của ZAP là ứng dụng được viết bằng Java nên có thể triển khai trên
nhiều nền tảng và có cộng đồng phát triển thường xuyên cập nhập các tri thức
liên quan đến lỗ hổng hiện hành.

\subsubsection{ZAP Core}

ZAP Core là thành phần lõi cung cấp toàn bộ API giao tiếp với bên ngoài cho các
plugin (bao gồm các luật, Addon) trong ZAP. Các plugin sẽ không trực tiếp giao tiếp
với môi trường bên ngoài mà sẽ sử dụng các API này để  gửi và nhận yêu cầu, đọc ghi
dữ liệu, ghi cơ sở dữ liệu\ldots Thành phần chính ZAP Core được phát triển từ dự án
Paros Proxy - là một Interceptor Proxy thường được sử dụng để để thử các ca kiểm thử
xâm nhập.

Các thành phần đáng kể nhất của ZAP Core phải kể đến là: Proxy, HttpSender, Session,
Site Map, Scanner, Context và các Addon Core. Proxy chính là interceptor được kế thừa
từ Paros, cho phép nhặn gửi-nhận các yêu cầu, phản hồi tới và đi qua Proxy. Thông
thường, các trình duyệt sẽ sử dụng thông qua proxy này để thực hiện kiểm thử. Http
Sender sẽ quản lý việc gửi và nhận của các thông báo HTTP. Session và Site Map sẽ quản lý
lượng đầu ra và đầu vào các thông báo HTTP, để xây dựng thành một cây thông tin cung
cấp các thành phần khác. Scanner cung cấp một khung để các luật thực hiện xác định
lỗ hổng trên các thông báo HTTP. Context cung cấp ngữ cảnh cho việc rà quét, xác định
lỗ hộng theo người dùng.

Ngoài ra, một số Addon sẽ được phát triển như một phần của ZAP Core thay vì
là các phần mở rộng thông thường và cũng được các Addon khác sử dụng như
một phần của ZAP Core.

\subsection{ZAP Addons}
Điểm đặc biệt của ZAP là cơ chế mở rộng bằng ZAP Addons cho phép cộng đồng
xây dựng được các phần mở rộng riêng cho mình trên ZAP mà không cần sửa
các phần liên quan đến ZAP Core, đảm bảo sự độc lập tránh sự mâu thuẫn giữa
các ZAP Addon hoặc ZAP Addon với chính ZAP, đồng thời cũng đảm bảo được các
phần được bảo trị độc lập liên tục.

\subsubsection{Addon Spider và Addon Spider Ajax}
Spider là một trong các Addons chính, được phát triển để Crawl và phát
hiện được các thành phần đơn trong Website như các URL, hành động,...được gọi là các
Site Node. Site Node cung cấp sẽ thông tin cho người dùng về thông tin
Website đồng thời cũng cung cấp các thông tin về Website cho các Addon
khác thông qua các API của ZAP.

Spider sẽ crawl dựa trên cây DOM của Website, do đó Spider này sẽ chỉ nhận
được các thông tin từ web tĩnh. Để lấy được các thông tin trong việc chạy
JavaScript thì cần có một Addon khác là Ajax Spider. Ajax spider sử dụng
Selenium như một trình web để duyệt web ảo và thực hiện thu thập các thông
tin về Site Node.
\subsubsection{Addon Passive Scan và Active Scan}
Là các Addons chính, được sử dụng để chạy các kiểm thử dạng được lập trình
sẵn thành các plugin đặc biệt gọi là luật(Rule). Các luật sẽ dựa theo thông
tin của hệ thống cung cấp để chạy các ca kiểm thử và phân tích kết quả dựa
trên các hành vi của Website để đưa ra các cảnh báo (Alert) cho người dùng.

Passive Scan sẽ chỉ sử dụng các phản hồi của proxy để lấy tông tin, thường
các lỗ hổng liên quan đến lộ thông tin sẽ được phát hiện bằng trình quét này.

Active Scan sẽ chủ động gửi các truy cấn để phát hiện ra lỗ hổng dựa vào
các hành vi của Web trả lại. Nhược điểm của trình quét này sẽ gửi số lượng
lớn và các truy vấn tới mọi Site Node của Website có thế dẫn đến các hành vi
không mong muốn đối với Website mục tiêu.

Các luật liên tục được cộng đồng duy trì và phát triển theo các lỗ hổng
đã xuất hiện và hiện hành.

\subsection{Lỗ hổng ứng dụng Web}

Hiện nay, có rất nhiều kĩ thuật tấn công vào ứng dụng Web bao gồm cả phía
máy chủ và phía máy khách. Dưới đây mà một số lỗ hổng được trình bày trong
phạm vi được khai thác trong khóa luận.

\subsubsection{SQL Injection}

Với các ứng dụng Web hiện nay, việc lưu trữ dữ liệu thường được lưu tại
cơ sở dữ liệu. Các cơ sở dữ liệu đến ngày nay vẫn là một cơ sở dữ liệu
phổ biến do sự tin cậy và tốc độ của chúng. Để truy vấn được đến các dữ
liệu này, các máy chủ Web cần sử dụng các truy vấn SQL để lấy dữ liệu đến
người dùng. Tuy nhiên, sự không kiểm soát các đầu vào của người dùng có
thể khiển các câu lệnh truy vấn SQL có thể bị thay đổi để thực thi các câu
lệnh bất thường làm lộ thông tin Cơ sở dữ liệu hoặc tệ hơn nữa làm cho cơ
sở dữ liệu mất quyền kiểm soát.

Ví dụ với ngôn ngữ PHP dưới đây
\begin{lstlisting}[language=php, caption=SQL Injection]
    // The article parameter is assigned to $article
    // variable without any sanitization or validation
    $articleid = $_GET['article'];
    // The $articleid parameter is passed as part of
    // the query
    $query = "SELECT * FROM articles WHERE
    articleid = $articleid";
\end{lstlisting}
Khi người dùng tùy chỉnh tham số `article` thành các câu lệnh dạng như
`1 or 1=1-- -` sẽ khiến vô tình dữ liệu của toàn bộ bảng `article` được
đưa ra ngoài.

Không chỉ tại câu lệnh truy vấn đó, các câu lệnh có thể sử dụng để lấy toàn
bộ cơ sở dữ liệu thậm chí là đặt cửa hậu để tấn công về sau.

Hiện nay các kĩ thuật tấn công rất đang dạng như boolean-based blind,
time-based blind, error-based, UNION query-based, stacked queries and
Out-of-band.

\subsubsection{OS Command Injection}
OS Commnad Injection là lỗ hổng cho phép thực thi các câu lệnh
của hệ điều hành trái phép. Nguyên do cũng đến từ việc cho phép người dùng
nhập trực tiếp hoặc xử lý không hết hoàn toàn các câu lệnh thực thi trên
máy chủ Web. Các lỗ hổng này thường dẫn đến thực thi lệnh trái phép trên
máy chủ Web.

\subsubsection{Remote Code Evaluation}
Remote Code Evaluation là lỗ hổng cho phép thực thi các đoạn mã trái phép trên trình
phân tích cú pháp của ngôn ngữ - thường xảy ra với các ngôn ngữ thông dịch.
Các đầu vào khi không được kiểm soát hoàn toàn có thể khiển các đoạn mã
được thực thi trái phép. Các lỗ hổng dạng này cũng thường dẫn đến thực thi
lệnh trái phép trên máy chủ Web.

\subsubsection{Server Side Template Injection}
Tương tự với Remote Code Evaluation, Server Side Template Injection cũng
cho phép thực thi các đoạn mã trên trình phân tích của Template Engine.
Template Engine là các phần thực hiện việc phân tích cú pháp, thực thi
các đoạn mã để sinh ra được nhiều đầu ra khác nhau thông qua một bản mẫu
chỉ cần thay đổi tham số đầu vào. Lỗ hổng này cũng thường dẫn đến việc thực
thi lệnh trái phép trên máy chủ Web.

Ba lỗ hổng OS Command Injection, Remote Code Evaluation và Server Side Template Injection
có vector khai thác và mức độ tác động tương tự nhau nên trong một số trường hợp
được gọi chung với cái tên Code Injection.

\subsubsection{Local File Inclusion và Directory Traversal}
Local File Inclusion là lỗ hổng làm cho máy chủ làm lộ hoặc thực thi các
nội dung tập tin trên máy chủ đó. Trong các trường hợp như PHP, khi được
phép tải lên tùy ý tập tin lên thì lỗ hổng này có thể dẫn đến thực thi lệnh
trái phép trên máy chủ Web.

Kể cả khi không được tải lên tùy ý, lỗ hổng Local File Inclusion cũng
thường được kết hợp với Directory Traversal, cho phép tùy ý đọc tập tin
tại vị trí không được phép để làm lộ các thông tin nhạy cảm của hệ thống.

\subsubsection{Remote File Inclusion}

Tương tự như Local File Inclusion, Remote File Inclusion cho phép máy chủ
làm lộ hoặc thực thi các tập tin nhưng với nội dung từ xa. Thường thì các
dẫn đến thực thi lệnh trái phép trên máy chủ Web.

\subsection{Công cụ SQL Map}
SQLMap là Một công cụ mã nguồn mở được sử dụng để tự động quá trình xác
định, khai thác và hậu khai thác các lỗ hổng về SQL Injection.

SQLMap được cộng đồng phát triển với một engine có khả năng phát hiện các
lỗ hổng ở một miền lỗ hổng cực kỳ rộng và cho rất nhiều hệ thống khác nhau.
Đồng thời nó cũng có các công cụ khai thác dựa trên các lỗ hổng được phát
hiện trên dump cơ sở dữ liệu hiệu quả.

Hiện nay SQLMap, hỗ trợ gần như các cơ sở dữ liệu phổ biển như MySQL,
Oracle, PostgreSQL, Microsoft SQL Server, Microsoft Access, IBM DB2,
SQLite, Firebird, Sybase, SAP MaxDB, Informix, MariaDB, MemSQL, TiDB,
CockroachDB, HSQLDB, H2,... với rất nhiều kỹ thuật như boolean-based blind,
time-based blind, error-based, UNION query-based, stacked queries and
out-of-band. Ngoài ra, SQLMap giúp liệt kê bằng các thông tin của cơ
sở dữ liệu nếu users, password hashes, privileges, roles, databases,
tables and columns.

\subsection{Công cụ Commix}
Commix (viết tắt của command injection exploiter) là một công cụ mã nguồn
mở được sử dụng để tự động xác định, khai thác và hậu khai thác các lỗ
hổng về Command Injection. Một số lỗ hổng liên quan đến
Remote Code Evaluation cũng có thể được phát hiện và khai thác bằng công
cụ này.

Commix cũng được cộng đồng phát triển để có khả năng khai
thác một miền rộng các lỗ hổng trên nhiều hệ điều hành khác nhau
và có thể thực hiện hậu khai thác ở đây.
\subsection{Công cụ Tplmap}
Tplmap là một công cụ mã nguồn mở được sử dụng để xác minh và khai
thác các lỗ hổng liên quan đến Code Injection and Server-Side Template
Injection.


Hơn 15 ngôn ngữ, template engine có thể bị khai thác với nhiều kỹ thuật
khác nhau kể các các lỗ hổng dạng mù.
\end{document}